{"version":3,"file":"index.module.js","sources":["../src/core/command.ts","../src/core/commands/g/index.ts","../src/core/commands/g/project.ts","../src/core/commands/g/package.ts","../src/index.ts"],"sourcesContent":["import { Command } from \"commander\"\nimport { version } from \"../../package.json\"\n\nexport const command = new Command()\n\ncommand.version(version)\n","import { Command } from \"commander\"\nimport { pro } from \"./project\"\nimport { pack } from \"./package\"\n\nexport interface GAction {\n  (target: string): void\n}\n\nconst actionMap: Record<string, GAction> = {\n  pro,\n  pack,\n}\n\nexport const g = (command: Command) => {\n  command\n    .command(\"g <type> [name]\")\n    .description(\"创建文件\")\n    .action((type: string, name: string = \"unknown\") => {\n      if (type in actionMap && typeof actionMap[type] === \"function\") {\n        actionMap[type](name)\n        return\n      }\n      throw new TypeError(\"搞出问题了！没有对应模式!!\")\n    })\n}\n","import { join, resolve } from \"path\"\nimport { copy, writeFile } from \"fs-extra\"\n\nconst getPkg = (dest: string) => {\n  try {\n    require(join(dest, \"package.json\"))\n  } catch (e) {\n    return {} as any\n  }\n}\n\nexport const pro = async (name: string) => {\n  const cwd = resolve(name)\n  const src = join(__dirname, \"../templates/root-project\")\n\n  try {\n    await copy(src, cwd)\n    const { spawn } = require(\"child_process\")\n\n    const pkg = getPkg(cwd)\n    const command = spawn(\"npx\", [\"lerna\", \"bootstrap\"], {\n      stdio: \"inherit\",\n      cwd,\n    })\n\n    pkg.name = name\n\n    await writeFile(\n      join(cwd, \"package.json\"),\n      JSON.stringify(pkg, undefined, 2)\n    )\n\n    command.on(\"close\", () => {})\n  } catch (e) {}\n}\n","import { copy, writeFile } from \"fs-extra\"\nimport { join, resolve } from \"path\"\n\nexport const getPkg = () => {\n  let pkg: any\n  try {\n    pkg = require(resolve(\"package.json\"))\n  } catch (e) {\n    pkg = {} as any\n  }\n  return pkg\n}\n\nexport const pack = async (target: string) => {\n  const { spawn } = require(\"child_process\")\n  const pkg = getPkg()\n  const fullName = `@${pkg.name || \"unknown\"}/${target}`\n  const src = join(__dirname, \"../templates/package\")\n  const dest = resolve(`packages/${target}`)\n  try {\n    await copy(src, dest)\n\n    const packagePkgPath = join(dest, \"package.json\")\n    const packagePkg = require(packagePkgPath)\n    const command = spawn(\"npx\", [\"lerna\", \"bootstrap\"], {\n      stdio: \"inherit\",\n    })\n\n    packagePkg.name = fullName\n    await writeFile(packagePkgPath, JSON.stringify(packagePkg, undefined, 2))\n\n    command.on(\"close\", () => {})\n  } catch (e) {\n    console.log(e)\n  }\n}\n","#!/usr/bin/env node\nimport { Command } from \"commander\"\nimport { command } from \"@/core/command\"\nimport { g } from \"@/core/commands/g\"\n\ng(command as Command)\ncommand.parse(process.argv)\n"],"names":["command","Command","version","actionMap","pro","name","cwd","resolve","src","join","__dirname","copy","spawn","require","pkg","dest","e","getPkg","stdio","writeFile","JSON","stringify","undefined","on","pack","target","fullName","packagePkgPath","packagePkg","console","log","description","action","type","TypeError","g","parse","process","argv"],"mappings":";gIAGaA,EAAU,IAAIC,EAE3BD,EAAQE,qBCGFC,EAAqC,CACzCC,aCEwBC,OACxB,IAAMC,EAAMC,EAAQF,GACdG,EAAMC,EAAKC,UAAW,uEAGpBC,EAAKH,EAAKF,wBACRM,EAAUC,QAAQ,iBAAlBD,MAEFE,EAhBK,SAACC,GACd,IACEF,QAAQJ,EAAKM,EAAM,iBACnB,MAAOC,GACP,MAAO,IAYKC,CAAOX,GACbN,EAAUY,EAAM,MAAO,CAAC,QAAS,aAAc,CACnDM,MAAO,UACPZ,IAAAA,IAPA,OAUFQ,EAAIT,KAAOA,kBAELc,EACJV,EAAKH,EAAK,gBACVc,KAAKC,UAAUP,OAAKQ,EAAW,qBAGjCtB,EAAQuB,GAAG,QAAS,kJArBR,oCDDdC,cEGyBC,WACjBb,EAAUC,QAAQ,iBAAlBD,MAEFc,OAbc,WACpB,IAAIZ,EACJ,IACEA,EAAMD,QAAQN,EAAQ,iBACtB,MAAOS,GACPF,EAAM,GAER,OAAOA,EAKKG,GACaZ,MAAQ,eAAaoB,EACxCjB,EAAMC,EAAKC,UAAW,wBACtBK,EAAOR,cAAoBkB,6CAEzBd,EAAKH,EAAKO,oBAEhB,IAAMY,EAAiBlB,EAAKM,EAAM,gBAC5Ba,EAAaf,QAAQc,GACrB3B,EAAUY,EAAM,MAAO,CAAC,QAAS,aAAc,CACnDM,MAAO,YANP,OASFU,EAAWvB,KAAOqB,kBACZP,EAAUQ,EAAgBP,KAAKC,UAAUO,OAAYN,EAAW,qBAEtEtB,EAAQuB,GAAG,QAAS,uFACbP,GACPa,QAAQC,IAAId,mEApBC,sCFAA,SAAChB,GAChBA,EACGA,QAAQ,mBACR+B,YAAY,QACZC,OAAO,SAACC,EAAc5B,GACrB,YADqBA,IAAAA,EAAe,aAChC4B,KAAQ9B,IAAwC,mBAApBA,EAAU8B,GAI1C,UAAUC,UAAU,kBAHlB/B,EAAU8B,GAAM5B,KGdxB8B,CAAEnC,GACFA,EAAQoC,MAAMC,QAAQC"}